# Контроллер для взаимодействия с API Sendsay

Сам контроллер находится в файле controller.py  
Клиент для взаимодействия с API через контроллер - client.py  
  
Перед началом работы необходимо в файле config.json указать свои авторизационные данные (логин, саблогин, пароль). Если нет саблогина, то оставить пустые кавычки   
  
При запуске client.py будет следующая подсказка:  
<a href="https://imgbb.com/"><img src="https://i.ibb.co/qkM8FCs/image.png" alt="image" border="0"></a>  
  
### 1) Создание группы  
Для создания группы необходимо, чтобы файл data.json выглядел следующим образом:  
```json
{
  "data": {
    "id": "new_group", - id группы
    "name": "new_group", - имя группы
    "type": "list" - тип группы
  }
}
```
Также в файле users.txt нужно указать пользователей (каждый с новой строки). Указываются только те пользователи, которые имеются у вас в подписчиках на платформе Sendsay. Пример файла находится в данном репозитории.  
После заполнения обоих файлов, в терминале в программе client.py вводим цифру 1. Если все выполнено верно, то будет создана группа, а ответ с АПИ сервера отобразится в терминале  
  
### 2) Создание рассылки для одной группы
Для создания рассылки необходимо, чтобы файл data.json выглядел следующим образом:
```json
{
  "data": {
    "name": "first_edition", - название рассылки
    "letter": {
        "subject": "test letter", - тема письма
        "from.name": "test sender", - от кого письмо (имя)
        "from.email": "sender@yahoo.com", - от кого письмо (email)
        "reply.name": "sender name", - кому отвечать (имя)
        "reply.email": "sender@yahoo.com", - кому отвечать (email)
        "to.name": "to name", - имя получателя
        "message": {
            "text": "здесь находится текст письма" - сам текст письма
        }
    },
    "group": "new_group", - название группы
    "sendwhen": "now", - когда отправлять
    "users.slice": "100%" - количество пользователей из указанной выше группы, которое охватывает рассылка
  }
}
```
После заполнения файла, в терминале в программе client.py вводим цифру 2. Если все выполнено верно, то будет создана рассылка по указанной группе, а ответ с АПИ сервера отобразится в терминале  
  
### 3) Создание рассылки для нескольких групп
Для создания рассылки необходимо, чтобы файл data.json выглядел следующим образом:
```json
{
  "data": {
    "name": "first_edition", - название рассылки
    "letter": {
        "subject": "test letter", - тема письма
        "from.name": "test sender", - от кого письмо (имя)
        "from.email": "sender@yahoo.com", - от кого письмо (email)
        "reply.name": "sender name", - кому отвечать (имя)
        "reply.email": "sender@yahoo.com", - кому отвечать (email)
        "to.name": "to name", - имя получателя
        "message": {
            "text": "здесь находится текст письма" - сам текст письма
        }
    },
    "sendwhen": "now", - когда отправлять
    "users.slice": "100%" - количество пользователей из указанной выше группы, которое охватывает рассылка
  }
}
```
Единственное отличие данного json-файла от предыдущего - отсутствие ключа "group". Вместо этого указывается несколько групп в файле groups.txt (каждый с новой строки). Пример находится в данном репозитории.  
После заполнения файла, в терминале в программе client.py вводим цифру 3. Если все выполнено верно, то будет создана рассылка по указанному списку групп, а ответы с АПИ сервера отобразится в терминале  
  
### 4) Информация о всех подписчиках  
В терминале в программе client.py вводим цифру 4. В консоли должен отобразиться ответ с информацией о всех подписчиках. Подписчики будут сгруппированы по типу уведомления  
  
### 5) Список подписчиков по типу уведомления  
Для запроса информации о подписчиках по типу уведомления необходимо, чтобы файл data.json выглядел следующим образом:
```json
{
  "data": {
    "addr_type": "email" - тип уведомления (email, msisdn (номер телефона), viber, csid, push, vk, tg)
  }
}
```
В терминале в программе client.py вводим цифру 5. В консоли должен отобразиться ответ с информацией о подписчиках по указанному типу уведомления.
